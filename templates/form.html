<!doctype html><html lang="es"><head>  <meta charset="utf-8">  <title>VPN Fortigate ? Palo Alto</title>  <style>    body { font-family: sans-serif; max-width: 900px; margin: 0 auto; }    fieldset { margin-bottom: 1.5rem; }    label { display: block; margin-top: 0.5rem; }    input { width: 100%; padding: 0.3rem; }    .messages { margin: 1rem 0; }    .msg-error { color: #b00020; }    .msg-success { color: #006400; }  </style></head><body>  <h1>Parámetros mínimos VPN IPSec Fortigate ? Palo Alto</h1>  <div class="messages">    {% with messages = get_flashed_messages(with_categories=true) %}      {% if messages %}        {% for category, message in messages %}          <div class="msg-{{ category }}">{{ message }}</div>        {% endfor %}      {% endif %}    {% endwith %}  </div>  <form method="post" novalidate>    <fieldset>      <legend>VPN</legend>      <label>Nombre de la VPN (máx 30 chars, letras/números/_/-)</label>      <input type="text" name="vpn_name" maxlength="30" required             pattern="[A-Za-z0-9_-]{1,30}"             value="{{ form.get('vpn_name','') }}">      <label>PSK (mínimo 12 caracteres, sin espacios)</label>      <input type="password" name="psk" minlength="12" required             pattern="\S{12,}">    </fieldset>    <fieldset>      <legend>Fortigate (Sitio 1)</legend>      <label>IP de gestión</label>      <input type="text" name="fgt_mgmt_ip" required             pattern="^((25[0-5]|2[0-4][0-9]|1?[0-9]?[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1?[0-9]?[0-9])$"             value="{{ form.get('fgt_mgmt_ip','') }}">      <label>Usuario</label>      <input type="text" name="fgt_mgmt_user" required             maxlength="32"             value="{{ form.get('fgt_mgmt_user','') }}">      <label>Password</label>      <input type="password" name="fgt_mgmt_pass" required>      <label>Interfaz WAN (ej: port1)</label>      <input type="text" name="fgt_wan_if" required maxlength="20"             pattern="[A-Za-z0-9_-]{1,20}"             value="{{ form.get('fgt_wan_if','port1') }}">      <label>Zona WAN (ej: WAN)</label>      <input type="text" name="fgt_wan_zone" required maxlength="20"             pattern="[A-Za-z0-9_-]{1,20}"             value="{{ form.get('fgt_wan_zone','WAN') }}">      <label>Interfaz LAN principal (ej: port2)</label>      <input type="text" name="fgt_lan_if" required maxlength="20"             pattern="[A-Za-z0-9_-]{1,20}"             value="{{ form.get('fgt_lan_if','port2') }}">      <label>Zona LAN (ej: LAN_S1)</label>      <input type="text" name="fgt_lan_zone" required maxlength="20"             pattern="[A-Za-z0-9_-]{1,20}"             value="{{ form.get('fgt_lan_zone','LAN_S1') }}">    </fieldset>    <fieldset>      <legend>Palo Alto (Sitio 2)</legend>      <label>IP de gestión</label>      <input type="text" name="pa_mgmt_ip" required             pattern="^((25[0-5]|2[0-4][0-9]|1?[0-9]?[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1?[0-9]?[0-9])$"             value="{{ form.get('pa_mgmt_ip','') }}">      <label>Usuario</label>      <input type="text" name="pa_mgmt_user" required maxlength="32"             value="{{ form.get('pa_mgmt_user','') }}">      <label>Password</label>      <input type="password" name="pa_mgmt_pass" required>      <label>Interfaz WAN (ej: ethernet1/1)</label>      <input type="text" name="pa_wan_if" required maxlength="30"             pattern="[A-Za-z0-9_/-]{1,30}"             value="{{ form.get('pa_wan_if','ethernet1/1') }}">      <label>Zona WAN (ej: untrust)</label>      <input type="text" name="pa_wan_zone" required maxlength="30"             pattern="[A-Za-z0-9_-]{1,30}"             value="{{ form.get('pa_wan_zone','untrust') }}">      <label>Interfaz TRUST principal (ej: ethernet1/2)</label>      <input type="text" name="pa_trust_if" required maxlength="30"             pattern="[A-Za-z0-9_/-]{1,30}"             value="{{ form.get('pa_trust_if','ethernet1/2') }}">      <label>Zona TRUST (ej: trust)</label>      <input type="text" name="pa_trust_zone" required maxlength="30"             pattern="[A-Za-z0-9_-]{1,30}"             value="{{ form.get('pa_trust_zone','trust') }}">      <label>Virtual Router (ej: VR1)</label>      <input type="text" name="pa_vr_name" required maxlength="30"             pattern="[A-Za-z0-9_-]{1,30}"             value="{{ form.get('pa_vr_name','VR1') }}">      <label>Interfaz túnel (ej: tunnel.1)</label>      <input type="text" name="pa_tunnel_if" required maxlength="30"             pattern="[A-Za-z0-9_.-]{1,30}"             value="{{ form.get('pa_tunnel_if','tunnel.1') }}">      <label>Zona VPN (ej: vpn)</label>      <input type="text" name="pa_vpn_zone" required maxlength="30"             pattern="[A-Za-z0-9_-]{1,30}"             value="{{ form.get('pa_vpn_zone','vpn') }}">    </fieldset>    <button type="submit">Generar vpn_params.yaml</button>  </form></body></html>