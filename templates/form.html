<!doctype html><html lang="es"><head>  <meta charset="utf-8">  <title>Challenge ML – VPN IPSec</title>  <style>    body {      font-family: Arial, sans-serif;      background-color: #1e1e1e;      color: #eee;    }    .container {      max-width: 900px;      margin: 40px auto;      background: #2b2b2b;      padding: 20px 30px;      border-radius: 8px;      box-shadow: 0 0 10px #000;    }    .header {      display: flex;      align-items: center;      justify-content: center;      gap: 15px;      margin-bottom: 10px;    }    .header img {      height: 48px;    }    h1 {      margin: 0;    }    p {      font-size: 14px;      color: #ccc;    }    table {      width: 100%;      border-collapse: collapse;      margin-top: 15px;      table-layout: fixed;          /* mismas proporciones en todas las filas */    }    th, td {      border: 1px solid #555;      padding: 8px;      text-align: left;      vertical-align: middle;    }    th {      background: #444;      text-align: center;    }    /* 1ª columna = 50%, 2ª columna = 50% */    table td:first-child {      width: 50%;    }    table td:last-child {      width: 50%;    }    /* INPUTS/SELECTS: ocupan todo el ancho de su celda (50% de la tabla) */    input[type="number"],    input[type="text"],    input[type="password"],    select {      padding: 6px;      border-radius: 4px;      border: 1px solid #555;      background: #111;      color: #eee;      box-sizing: border-box;      width: 100%;      display: block;      margin: 0;    }    .btn {      margin-top: 15px;      padding: 10px 16px;      border: none;      border-radius: 4px;      background: #007bff;      color: white;      font-size: 14px;      cursor: pointer;    }    .btn:hover {      background: #0069d9;    }    .btn-group {      margin-top: 15px;      display: flex;      gap: 10px;      flex-wrap: wrap;    }    .alert-error {      background: #661515;      color: #ffd0d0;      padding: 10px;      border-radius: 4px;      margin-top: 15px;    }    .alert-ok {      background: #155724;      color: #d4edda;      padding: 10px;      border-radius: 4px;      margin-top: 15px;    }    .result {      margin-top: 30px;      padding: 15px;      background: #333;      border-radius: 4px;      white-space: pre-wrap;      font-family: "Consolas", monospace;      font-size: 13px;    }    .section-title {      margin-top: 20px;      font-weight: bold;      border-bottom: 1px solid #555;      padding-bottom: 4px;    }  </style></head><body><div class="container">  <div class="header">    <!-- <img src="{{ url_for('static', filename='ml_logo.png') }}" alt="ML Logo"> -->    <h1>Challenge ML – VPN IPSec Fortigate ↔ Palo Alto</h1>  </div>  <p>    Completa los parámetros mínimos para generar automáticamente el archivo    <code>vpn_params.yaml</code> que se usará para configurar la VPN IPSec    entre el Fortigate (Sitio 1) y el Palo Alto (Sitio 2).  </p>  <div class="messages">    {% with messages = get_flashed_messages(with_categories=true) %}      {% if messages %}        {% for category, message in messages %}          <div class="alert-{{ 'error' if category == 'error' else 'ok' }}">{{ message }}</div>        {% endfor %}      {% endif %}    {% endwith %}  </div>  <form method="post" novalidate>    <!-- VPN -->    <div class="section-title">Parámetros de la VPN</div>    <table>      <tr>        <td>Nombre de la VPN<br><small>(máx 30 chars, letras/números/_/-)</small></td>        <td>          <input type="text" name="vpn_name" maxlength="30" required                 pattern="[A-Za-z0-9_-]{1,30}"                 value="{{ form.get('vpn_name','') }}">        </td>      </tr>      <tr>        <td>PSK<br><small>(mínimo 12 caracteres, solo ASCII seguro)</small></td>        <td>          <!-- Permitidos: A-Z a-z 0-9 ! # $ % & ( ) * + , - . / : ; < = > ? @ [ ] ^ _ { | } ~ -->          <input type="password" name="psk"                 minlength="12" required                 pattern="[A-Za-z0-9!#$%&()*+,./:;<=>?@\[\]^_{|}~-]{12,}"                 title="Mínimo 12 caracteres. Permitidos: letras, números y ! # $ % & ( ) * + , - . / : ; < = > ? @ [ ] ^ _ { | } ~">        </td>      </tr>      <tr>        <td>Grupo Diffie-Hellman (IKE / PFS)<br>          <small>Solo grupos compatibles Fortigate / Palo Alto</small>        </td>        <td>          <select name="dh_group" required>            <option value="14" selected>14 – MODP 2048 (recomendado)</option>            <option value="19">19 – ECP 256</option>            <option value="20">20 – ECP 384</option>            <option value="21">21 – ECP 521</option>            <option value="5">5 – MODP 1536 (legacy)</option>            <option value="2">2 – MODP 1024 (legacy, no recomendado)</option>          </select>        </td>      </tr>    </table>    <!-- FORTIGATE -->    <div class="section-title">Fortigate – Sitio 1</div>    <table>      <tr>        <td>IP de gestión</td>        <td>          <input type="text" name="fgt_mgmt_ip" required                 pattern="^((25[0-5]|2[0-4][0-9]|1?[0-9]?[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1?[0-9]?[0-9])$"                 title="Debe ser una dirección IPv4 válida. Ej: 192.168.1.10"                 value="{{ form.get('fgt_mgmt_ip','') }}">        </td>      </tr>      <tr>        <td>Usuario</td>        <td>          <input type="text" name="fgt_mgmt_user" required maxlength="32"                 value="{{ form.get('fgt_mgmt_user','') }}">        </td>      </tr>      <tr>        <td>Password</td>        <td>          <input type="password" name="fgt_mgmt_pass" required>        </td>      </tr>      <tr>        <td>Interfaz WAN (ej: port1)</td>        <td>          <input type="text" name="fgt_wan_if" required maxlength="20"                 pattern="[A-Za-z0-9_-]{1,20}"                 value="{{ form.get('fgt_wan_if','port1') }}">        </td>      </tr>      <tr>        <td>Zona WAN (ej: WAN)</td>        <td>          <input type="text" name="fgt_wan_zone" required maxlength="20"                 pattern="[A-Za-z0-9_-]{1,20}"                 value="{{ form.get('fgt_wan_zone','WAN') }}">        </td>      </tr>      <tr>        <td>Interfaz LAN principal (ej: port2)</td>        <td>          <input type="text" name="fgt_lan_if" required maxlength="20"                 pattern="[A-Za-z0-9_-]{1,20}"                 value="{{ form.get('fgt_lan_if','port2') }}">        </td>      </tr>      <tr>        <td>Zona LAN (ej: LAN_S1)</td>        <td>          <input type="text" name="fgt_lan_zone" required maxlength="20"                 pattern="[A-Za-z0-9_-]{1,20}"                 value="{{ form.get('fgt_lan_zone','LAN_S1') }}">        </td>      </tr>    </table>    <!-- PALO ALTO -->    <div class="section-title">Palo Alto – Sitio 2</div>    <table>      <tr>        <td>IP de gestión</td>        <td>          <input type="text" name="pa_mgmt_ip" required                 pattern="^((25[0-5]|2[0-4][0-9]|1?[0-9]?[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1?[0-9]?[0-9])$"                 title="Debe ser una dirección IPv4 válida. Ej: 192.168.1.10"                 value="{{ form.get('pa_mgmt_ip','') }}">        </td>      </tr>      <tr>        <td>Usuario</td>        <td>          <input type="text" name="pa_mgmt_user" required maxlength="32"                 value="{{ form.get('pa_mgmt_user','') }}">        </td>      </tr>      <tr>        <td>Password</td>        <td>          <input type="password" name="pa_mgmt_pass" required>        </td>      </tr>      <tr>        <td>Interfaz WAN (ej: ethernet1/1)</td>        <td>          <input type="text" name="pa_wan_if" required maxlength="30"                 pattern="[A-Za-z0-9_/-]{1,30}"                 value="{{ form.get('pa_wan_if','ethernet1/1') }}">        </td>      </tr>      <tr>        <td>Zona WAN (ej: untrust)</td>        <td>          <input type="text" name="pa_wan_zone" required maxlength="30"                 pattern="[A-Za-z0-9_-]{1,30}"                 value="{{ form.get('pa_wan_zone','untrust') }}">        </td>      </tr>      <tr>        <td>Interfaz TRUST principal (ej: ethernet1/2)</td>        <td>          <input type="text" name="pa_trust_if" required maxlength="30"                 pattern="[A-Za-z0-9_/-]{1,30}"                 value="{{ form.get('pa_trust_if','ethernet1/2') }}">        </td>      </tr>      <tr>        <td>Zona TRUST (ej: trust)</td>        <td>          <input type="text" name="pa_trust_zone" required maxlength="30"                 pattern="[A-Za-z0-9_-]{1,30}"                 value="{{ form.get('pa_trust_zone','trust') }}">        </td>      </tr>      <tr>        <td>Virtual Router (ej: VR1)</td>        <td>          <input type="text" name="pa_vr_name" required maxlength="30"                 pattern="[A-Za-z0-9_-]{1,30}"                 value="{{ form.get('pa_vr_name','VR1') }}">        </td>      </tr>      <tr>        <td>Interfaz túnel (ej: tunnel.1)</td>        <td>          <input type="text" name="pa_tunnel_if" required maxlength="30"                 pattern="[A-Za-z0-9_.-]{1,30}"                 value="{{ form.get('pa_tunnel_if','tunnel.1') }}">        </td>      </tr>      <tr>        <td>Zona VPN (ej: vpn)</td>        <td>          <input type="text" name="pa_vpn_zone" required maxlength="30"                 pattern="[A-Za-z0-9_-]{1,30}"                 value="{{ form.get('pa_vpn_zone','vpn') }}">        </td>      </tr>    </table>    <div class="btn-group">      <button type="submit" class="btn">Generar vpn_params.yaml</button>    </div>  </form></div></body></html>